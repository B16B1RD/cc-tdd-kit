---
description: "要望からユーザーストーリーを作成し、受け入れ基準を設定。プロダクトオーナーの視点で価値を定義します。"
argument-hint: "作成したいストーリーの説明（例: ログイン機能）"
allowed-tools: ["Write", "Read", "LS", "WebSearch", "Bash"]
---

# ユーザーストーリーの作成

要望: $ARGUMENTS

## 実行内容

### 1. 本質分析（5つのなぜ）

要望の背景にある本質的なニーズを探ります。

### 2. プロジェクトタイプ判定と動的技術選定

**段階的に考えます：**

まず現在年を確認します：`date +%Y` で2025年であることを確認。

#### Step 1: プロジェクトタイプの判定

要求内容から最適なプロジェクトタイプを判定：

- **Web アプリケーション**: ウェブ、ブラウザ、UI、ゲーム、HTML関連
- **API サーバー**: API、サーバー、データベース、認証、バックエンド関連  
- **CLI ツール**: コマンド、ツール、スクリプト、自動化関連
- **データ分析**: 分析、機械学習、データ処理、可視化関連
- **システムツール**: システム、パフォーマンス、低レベル処理関連
- **モバイルアプリ**: モバイル、アプリ、React Native、Flutter関連

#### Step 2: 言語・技術スタックの動的検索と選択肢提示

判定されたプロジェクトタイプに対して、**現在年の最新技術動向を検索**：

**Web検索による最新技術情報の取得:**
- 「2025年 [プロジェクトタイプ] 最新 技術スタック おすすめ」で検索
- パッケージマネージャー、ビルドツール、テストフレームワークの最新動向を調査
- 複数の技術選択肢を収集

**ユーザーへの選択肢提示:**

各技術カテゴリで3段階の選択肢を提示：

```text
🎯 [プロジェクトタイプ] の技術スタック選択

📦 パッケージマネージャー:
1. 推奨: [最新で実績ある選択肢] - 理由: 高速・安定
2. 安定: [枯れた技術] - 理由: 互換性・採用実績
3. 実験的: [先端技術] - 理由: 最新機能・将来性

🔧 ビルドツール: [同様の3択]
🧪 テストフレームワーク: [同様の3択]
📝 言語/型システム: [同様の3択]

あなたの選択: 各カテゴリで 1, 2, 3 のいずれかを選択してください
例: パッケージマネージャー=1, ビルドツール=2, テスト=1, 言語=1
```

#### Step 3: 選択結果の保存

ユーザーの選択に基づいて `.claude/agile-artifacts/project-config.json` を作成：

```json
{
  "project_type": "判定結果",
  "selected_stack": {
    "package_manager": "ユーザー選択結果",
    "build_tool": "ユーザー選択結果",
    "test_framework": "ユーザー選択結果", 
    "language": "ユーザー選択結果",
    "additional_tools": ["lint", "format", "type-check"]
  },
  "selection_rationale": {
    "performance_priority": "高速性重視/安定性重視/実験性重視",
    "team_experience": "考慮事項",
    "project_constraints": "特別な制約"
  }
}
```

### 3. 技術選定の最新情報検索

選択された技術スタックについて、より詳細な最新情報を検索：

- 公式ドキュメントの最新バージョン情報
- ベストプラクティスとアンチパターン
- パフォーマンス特性と制約事項
- チーム導入時の注意点

### 4. ストーリー分割

以下の 3 つのリリースに分けて、段階的に価値を提供：

- **Release 0**: 最初の 30 分で見えるもの（2-3 ストーリー）
- **Release 1**: 基本的な価値（3-4 ストーリー）  
- **Release 2**: 継続的な価値（3-4 ストーリー）

### 3. ストーリー形式

```text
Story X.Y: [簡潔なタイトル]
As a [役割]
I want [機能]
So that [価値]

見積もり: XX分
受け入れ基準:
- [ ] 具体的で検証可能な条件1
- [ ] 具体的で検証可能な条件2
- [ ] 具体的で検証可能な条件3

確認履歴:
- [ ] 実装時の動作確認
- [ ] 統合時の確認
```

### 5. ファイル作成

以下の2つのファイルを作成：

**A. プロジェクト設定**: `.claude/agile-artifacts/project-config.json`
- プロジェクトタイプ判定結果
- 技術スタック情報
- 要件特性（deployment方法等）

**B. ユーザーストーリー**: `.claude/agile-artifacts/stories/project-stories.md`
- 本質分析の結果
- ペルソナと成功指標
- リリース計画（プロジェクトタイプ最適化済み）
- 各ストーリーの詳細
- プロジェクトタイプ別の確認方法

### 6. コミット

```bash
git add .claude/agile-artifacts/
git commit -m "[BEHAVIOR] Create user stories with project type analysis"
```

## 原則

- **YAGNI**: 今必要ない機能は含めない
- **検証可能**: 曖昧な基準を避ける
- **段階的**: 小さく始めて大きく育てる

## 完了後

```text
📝 ストーリーとプロジェクト設定を作成しました！

🎯 プロジェクト判定: [Web App/API/CLI]
🛠️ 技術スタック: [選択された技術群]
📊 ストーリー総数: X個、推定: Y時間

次: /tdd:init (判定結果ベースでモダン環境構築)
```
