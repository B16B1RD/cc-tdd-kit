---
description: "即座バグ修正TDDサイクル - MVP/Product段階の品質確保"
argument-hint: "修正したいバグを説明してください（例: 境界制限が効いていない）"
allowed-tools: ["Bash", "Read", "Write", "TodoWrite"]
---

# 即座バグ修正TDDサイクル

バグ内容: $ARGUMENTS

## 🎯 バグ修正専用TDDサイクル

**MVP/Product段階**での品質確保を目的とした即座修正フローです。

## 指示

以下の10分バグ修正サイクルを実行してください：

### 🔍 Phase 1: バグ再現確認（0-2分）

#### 1. 現在の動作状態確認
**バグが発生する状況**を具体的に再現してください：

- 現在のプロジェクトファイルを確認
- バグが発生する具体的な操作手順を実行
- 期待される動作と実際の動作のギャップを明確化

#### 2. バグの影響範囲評価
```text
🐛 バグ詳細分析:

発生状況: [具体的な操作や条件]
期待動作: [本来あるべき動作]
実際動作: [現在の問題ある動作]
影響範囲: [ユーザー体験への影響度]
修正優先度: [MVP基盤/Product品質への影響]
```

### 🔴 Phase 2: RED - バグ再現テスト作成（2-4分）

#### 3. バグを検出するテスト作成
**バグを確実に検出する最小限のテスト**を1つ作成してください：

```javascript
// 例: 境界制限バグの場合
test('ブロックが画面外に出ない', () => {
  const block = { x: 190, y: 100 }; // 画面幅200pxの場合
  moveRight(block);
  expect(block.x).toBeLessThanOrEqual(180); // ブロック幅20px考慮
});
```

#### 4. テスト実行でバグ確認
```bash
pnpm test -- --watchAll=false --forceExit 2>&1
```
⚠️ **必須**: テストが赤（失敗）でバグが確実に検出されることを確認

### 🟢 Phase 3: GREEN - バグ修正実装（4-8分）

#### 5. 最小限のバグ修正実装
**テストを緑にする最小限の修正**を実装してください：

```javascript
// 例: 境界制限修正
function moveRight(block) {
  const maxX = gameWidth - blockWidth;
  block.x = Math.min(block.x + moveSpeed, maxX);
}
```

#### 6. テスト成功とバグ解消確認
```bash
pnpm test -- --watchAll=false --forceExit 2>&1
```
✅ **目標**: テストが緑（成功）かつ実際の動作でバグが解消

#### 7. 実動作での修正確認
- **Web**: ブラウザで修正動作を直接確認
- **CLI**: コマンド実行で修正結果確認  
- **API**: curlで修正されたレスポンス確認

### 🔵 Phase 4: REFACTOR - 品質向上（8-9分）

#### 8. 必要に応じてコード品質向上
**バグ修正の安定性を高める改善**を実施：

- 関連する類似バグの予防的修正
- 変数名や関数名の明確化
- **重要**: 動作（体験）は絶対に変更しない

#### 9. 全テスト実行で品質確認
```bash
pnpm test -- --watchAll=false --forceExit 2>&1
pnpm lint 2>&1
```

### 🎉 Phase 5: 修正完了（9-10分）

#### 10. バグ修正コミット
```bash
git add .
git commit -m "[BEHAVIOR] Fix bug: [バグ内容の簡潔な説明]"
```

#### 11. 修正完了宣言
```text
✅ バグ修正完了！

🐛 修正内容: [具体的な修正内容]
🎯 結果: [期待通りの動作に修正]
⏱️ 修正時間: [実際の所要時間]

🚀 次のステップ:
✅ MVP/Product品質が向上しました
継続開発を再開できます
```

## 🎯 バグ修正後の選択肢

**バグ修正完了後**、以下から選択してください：

### ✅ 継続開発
1. **🚀 マイクロイテレーション継続** 
   ```bash
   /tdd:plan micro
   ```
   15分サイクルで新しい価値追加

2. **📈 機能拡張**
   ```bash
   /tdd:story [追加したい機能]
   ```
   新しいストーリー作成

### 🔍 追加確認
3. **🐛 他のバグ確認** - 類似バグの確認と修正
4. **🎮 品質テスト** - 全体的な動作品質の確認
5. **✅ 満足・完了** - 現在の品質で満足

## 🚨 重要原則

### バグ修正TDD原則
- **10分以内**: 長時間の修正は新機能開発と同じ扱い
- **最小修正**: 過度な改善は避け、バグ解消に集中
- **テスト保護**: 修正により他の機能が壊れないことを確認
- **体験優先**: 技術的完璧さよりユーザー体験の修正

### MVP/Product品質基準
- **MVP段階**: 成長基盤として機能する最低限の品質
- **Product段階**: 他人に見せられる製品レベルの品質
- **バグ修正優先**: 新機能より品質確保を優先

このバグ修正サイクルにより、MVP/Product段階での適切な品質確保を実現します。